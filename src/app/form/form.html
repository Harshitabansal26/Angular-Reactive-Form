<div class="form-container">
  <form [formGroup]="applicationForm" (ngSubmit)="onSubmit()">
    <h1>Business Onboarding: Add New Application</h1>

    <!-- Product Section -->
    <div class="form-section">
      <h2>Section: Product</h2>
      <div class="form-group required">
        <label>Product or service applying for</label>
        <div class="checkbox-group" formArrayName="product">
          <div *ngFor="let option of productOptions; let i = index" class="checkbox-item">
            <input type="checkbox" [formControlName]="i" [id]="option.value" />
            <label [for]="option.value">{{ option.name }}</label>
          </div>
        </div>
        <div *ngIf="productFormArray.invalid && applicationForm.get('product')?.touched" class="error-message">
          This field is required.
        </div>
      </div>
    </div>

    <!-- Application Source -->
    <div class="form-section">
      <h2>Section: Application Source</h2>
      <div class="form-group required">
        <label for="applicationSource">Application Received From</label>
        <select id="applicationSource" formControlName="applicationSource">
          <option value="">Select...</option>
          <option *ngFor="let source of lookupData.applicationReceiveFrom" [value]="source.key">
            {{ source.value }}
          </option>
        </select>
        <div *ngIf="applicationForm.get('applicationSource')?.invalid && applicationForm.get('applicationSource')?.touched" class="error-message">
          This field is required.
        </div>
      </div>
    </div>

    <!-- Personal Details -->
    <div class="form-section" formGroupName="personalDetails">
      <h2>Section: Personal Details</h2>

      <div class="form-group required">
        <label for="title">Title</label>
        <select id="title" formControlName="title">
          <option value="">Select...</option>
          <option *ngFor="let t of lookupData.title" [value]="t.key">{{ t.value }}</option>
        </select>
      </div>

      <div class="form-group required">
        <label for="firstName">First Name</label>
        <input id="firstName" type="text" formControlName="firstName" />
      </div>

      <div class="form-group">
        <label for="middleName">Middle Name</label>
        <input id="middleName" type="text" formControlName="middleName" />
      </div>

      <div class="form-group required">
        <label for="lastName">Last Name</label>
        <input id="lastName" type="text" formControlName="lastName" />
      </div>

      <div class="form-group required">
        <label for="email">Email</label>
        <input id="email" type="email" formControlName="email" />
      </div>

      <div class="form-group required">
        <label for="dateOfBirth">Date of Birth</label>
        <input id="dateOfBirth" type="date" formControlName="dateOfBirth" />
      </div>

      <div class="form-group required">
        <label for="cellphone">Cellphone</label>
        <input id="cellphone" type="tel" formControlName="cellphone" />
      </div>

      <div class="form-group">
        <label for="businessPhone">Business Phone</label>
        <input id="businessPhone" type="tel" formControlName="businessPhone" />
      </div>

      <div class="form-group">
        <label for="homePhone">Home Phone</label>
        <input id="homePhone" type="tel" formControlName="homePhone" />
      </div>

      <div class="form-group required">
        <label>Gender</label>
        <div class="radio-group">
          <input type="radio" id="gender-male" value="MALE" formControlName="gender" />
          <label for="gender-male">Male</label>
          <input type="radio" id="gender-female" value="FEMALE" formControlName="gender" />
          <label for="gender-female">Female</label>
        </div>
      </div>

      <div class="form-group required">
        <label>Are you a Jamaica Resident?</label>
        <select formControlName="isJamaicaResident">
          <option value="">Select...</option>
          <option value="YES">Yes</option>
          <option value="NO">No</option>
        </select>
      </div>

      <div class="form-group required">
        <label>Existing Retailer?</label>
        <select formControlName="existingRetailer">
          <option value="">Select...</option>
          <option value="YES">Yes</option>
          <option value="NO">No</option>
        </select>
      </div>

      <div class="form-group">
  <label for="retailerId">Retailer ID</label>
  <input id="retailerId" type="text" formControlName="retailerId" />
</div>

<div class="form-group">
  <label for="otherCreationReason">Other Creation Reason</label>
  <input id="otherCreationReason" type="text" formControlName="otherCreationReason" />
</div>


      <div class="form-group required">
        <label for="addCoApplicant">Add Co-Applicant?</label>
        <select id="addCoApplicant" formControlName="addCoApplicant">
          <option value="">Select...</option>
          <option value="YES">Yes</option>
          <option value="NO">No</option>
        </select>
      </div>
    </div>

    <!-- Business Information -->
    <div class="form-section" formGroupName="businessInformation">
      <h2>Section: Business Information</h2>

      <div class="form-group required">
        <label for="businessName">Business Name</label>
        <input id="businessName" type="text" formControlName="businessName" />
      </div>

      <div class="form-group required">
        <label for="country">Country</label>
        <select id="country" formControlName="country">
          <option value="">Select...</option>
          <option *ngFor="let c of lookupData.countryCode" [value]="c.key">{{ c.value }}</option>
        </select>
      </div>

      <div class="form-group required">
        <label for="parish">Parish</label>
        <select id="parish" formControlName="parish">
          <option value="">Select...</option>
          <option *ngFor="let p of lookupData.parishCounty" [value]="p.key">{{ p.key }} ({{ p.value }})</option>
        </select>
      </div>

      <div class="form-group">
        <label for="town">Town</label>
        <input id="town" type="text" formControlName="town" />
      </div>

      <div class="form-group">
        <label for="district">District</label>
        <input id="district" type="text" formControlName="district" />
      </div>

      <div class="form-group">
        <label for="postalCode">Postal Code</label>
        <input id="postalCode" type="text" formControlName="postalCode" />
      </div>

      <div class="form-group required">
        <label for="address">Address</label>
        <textarea id="address" formControlName="address"></textarea>
      </div>

      <div class="form-group required">
        <label for="doYouOwnBusiness">Do you own the business?</label>
        <select id="doYouOwnBusiness" formControlName="doYouOwnBusiness">
          <option value="">Select...</option>
          <option value="YES">Yes</option>
          <option value="NO">No</option>
        </select>
      </div>

      <div class="form-group required">
        <label for="yearsInOperation">Years in Operation</label>
        <input id="yearsInOperation" type="number" formControlName="yearsInOperation" min="0" />
      </div>
      <div class="form-group required">
  <label for="monthsInOperation">Months in Operation</label>
  <input id="monthsInOperation" type="number" formControlName="monthsInOperation" min="0" />
  <div *ngIf="businessInformation.get('monthsInOperation')?.invalid && businessInformation.get('monthsInOperation')?.touched" class="error-message">
    This field is required.
  </div>
</div>


      <div class="form-group required">
        <label for="ownOrRentLocation">Own or Rent Location</label>
        <select id="ownOrRentLocation" formControlName="ownOrRentLocation">
          <option value="">Select...</option>
          <option value="OWN">Own</option>
          <option value="RENT">Rent</option>
        </select>
      </div>
    </div>

    <!-- File Upload -->
    <div class="form-section">
      <h2>Section: File Upload</h2>
      <div
        class="file-upload-box"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        (drop)="onDrop($event)"
        (click)="fileInput.click()"
        #fileDropZone
      >
        <p>Drag and Drop to upload a file or <a href="#" (click)="$event.preventDefault()">Browse</a></p>
        <small>Supports max 1 file, 10MB. Formats: jpg, png, pdf, docx.</small>
      </div>
      <input type="file" id="uploadDocuments" (change)="onFileSelected($event)" #fileInput style="display: none;" />
      <div class="file-list">
        <div *ngFor="let file of uploadedFiles" class="file-item">{{ file.name }}</div>
      </div>
    </div>

    <!-- Buttons -->
    <div class="button-group">
      <button type="button" class="btn btn-cancel" (click)="applicationForm.reset()">Cancel</button>
      <button type="button" class="btn btn-create" (click)="openModal()">Create</button>
    </div>
  </form>
</div>

<!-- Modal -->
<div class="modal-overlay" *ngIf="isModalVisible">
  <div class="modal-content">
    <div class="modal-header">
      <h4>Confirm Submission</h4>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to submit this form?</p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-modal-cancel" (click)="closeModal()">Cancel</button>
      <button class="btn btn-modal-confirm" (click)="onSubmit()">Confirm</button>
    </div>
  </div>
</div>
